---
// Official n8n Chat Widget Component
// Uses the @n8n/chat package for proper integration
---

<!-- Container for n8n chat widget -->
<div id="n8n-chat"></div>

<script>
  import '@n8n/chat/style.css';
  import { createChat } from '@n8n/chat';

  // Initialize the chat widget when the page loads
  document.addEventListener('DOMContentLoaded', () => {
    createChat({
      webhookUrl: 'https://nexevo.app.n8n.cloud/webhook/4bf2a600-f2ad-401b-bdb3-71868b66b1ee/chat',
      mode: 'window',
      target: '#n8n-chat',
      showWelcomeScreen: false,
      initialMessages: [
        'Hi there! ðŸ‘‹',
        'I\'m here to help you with your website development needs. How can I assist you today?'
      ],
      i18n: {
        en: {
          title: 'Rapid Sites Assistant',
          subtitle: "",
          footer: '',
          getStarted: 'Start Chat',
          inputPlaceholder: 'Type your question here...',
          closeButtonTooltip: 'Close chat',
        },
      },
      loadPreviousSession: true,
      enableStreaming: true,
      metadata: {
        source: 'rapid-sites-website',
        version: '1.0'
      }
    });
  });
</script>

<style is:global>
  /* N8N Chat Widget Brand Override - Global styles to ensure production build inclusion */
  html:root,
  body:root,
  :root {
    --chat--color-primary: #1EBFBF !important; /* var(--color-brand-600) */
    --chat--color-primary-shade-50: #1ED4C7 !important; /* var(--color-brand-500) */
    --chat--color-primary-shade-100: #009A91 !important; /* var(--color-brand-800) */
    --chat--color-secondary: #1EBFBF !important;
    --chat--color-secondary-shade-50: #009A91 !important;
    --chat--header--background: #000000 !important; /* pure black */
    --chat--header--padding: 0.75rem 1rem !important; /* py-3 px-4 */
    --chat--heading--font-size: 0.875rem !important; /* text-sm */
    --chat--message--font-size: 0.75rem !important; /* text-xs */
    --chat--message--padding: 0.625rem 0.875rem !important;
    --chat--message-line-height: 1.4 !important;
    --chat--toggle--background: #e74266 !important; /* n8n pink */
    --chat--toggle--hover--background: #1ED4C7 !important; /* var(--color-brand-500) */
    --chat--toggle--active--background: #009A91 !important; /* var(--color-brand-800) */
    --chat--message--user--background: #1EBFBF !important; /* var(--color-brand-600) */
    --chat--message--user--color: #000000 !important; /* black text */
  }

  /* User message background - highest specificity override */
  #n8n-chat [data-role="user"],
  #n8n-chat .message-user,
  #n8n-chat [class*="user"],
  .n8n-chat [data-role="user"],
  .n8n-chat .message-user,
  .n8n-chat [class*="user"] {
    background: #1EBFBF !important; /* var(--color-brand-600) - exact brand teal */
    background-color: #1EBFBF !important;
    color: #000000 !important; /* black text */
  }

  /* Header styling - force black and custom font */
  #n8n-chat [data-chat-header],
  #n8n-chat .chat-header,
  #n8n-chat header,
  #n8n-chat [class*="header"],
  .n8n-chat [data-chat-header],
  .n8n-chat .chat-header,
  .n8n-chat header,
  .n8n-chat [class*="header"] {
    background: #000000 !important; /* pure black */
    background-color: #000000 !important;
  }

  /* Header text - smaller title, custom font */
  #n8n-chat .chat-header h3,
  #n8n-chat [data-chat-header] h3,
  #n8n-chat header h3,
  .n8n-chat .chat-header h3,
  .n8n-chat [data-chat-header] h3,
  .n8n-chat header h3 {
    font-family: "RapidSides Assistant", 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif !important;
    font-weight: 500 !important; /* font-medium */
    font-size: 0.875rem !important; /* text-sm */
    color: #ffffff !important;
  }

  /* Hide subtitle */
  #n8n-chat .chat-header p,
  #n8n-chat [data-chat-header] p,
  #n8n-chat header p,
  .n8n-chat .chat-header p,
  .n8n-chat [data-chat-header] p,
  .n8n-chat header p {
    display: none !important;
  }

  /* Darker teal for floating toggle button */
  .n8n-chat-toggle,
  button[class*="toggle"],
  [class*="chat-toggle"] {
    background: #009A91 !important; /* darker teal so it stands out on teal sections */
  }
</style>